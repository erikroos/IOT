
<!DOCTYPE html>

<html lang="nl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. Sensoren &#8212; Internet of Things</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Zoeken" href="../search.html" />
    <link rel="next" title="5. Project" href="5_project.html" />
    <link rel="prev" title="3. Aansluitingen" href="3_aansluitingen.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="nl">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo_iot.svg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Internet of Things</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Zoek in dit boek ..." aria-label="Zoek in dit boek ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="0_introductie.html">
   Internet of Things
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="1_voorbereiding.html">
   1. Voorbereiding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="2_micro_python.html">
   2. MicroPython
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="3_aansluitingen.html">
   3. Aansluitingen
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. Sensoren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="5_project.html">
   5. Project
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Schakel navigatie" aria-controls="site-navigation"
                title="Schakel navigatie" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download deze pagina"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/docs/4_sensoren.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download het bronbestand" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Afdrukken naar pdf"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Volledig scherm"
        title="Volledig scherm"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhoud
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#voorbereiding">
   4.1. Voorbereiding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperatuursensor">
   4.2. Temperatuursensor
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperatuur-meten">
   4.3. Temperatuur meten
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analoog-naar-digitaal">
     4.3.1. Analoog naar digitaal
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Sensoren</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Inhoud </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#voorbereiding">
   4.1. Voorbereiding
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperatuursensor">
   4.2. Temperatuursensor
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#temperatuur-meten">
   4.3. Temperatuur meten
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analoog-naar-digitaal">
     4.3.1. Analoog naar digitaal
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="sensoren">
<h1><span class="section-number">4. </span>Sensoren<a class="headerlink" href="#sensoren" title="Permalink naar deze titel">¶</a></h1>
<p>Sensoren komen in allerlei soorten en maten, bekend zijn beweging-, licht- en temperatuursensoren. In dit onderdeel ga je het ontwerp uitbreiden met een temperatuursensor.</p>
<div class="section" id="voorbereiding">
<h2><span class="section-number">4.1. </span>Voorbereiding<a class="headerlink" href="#voorbereiding" title="Permalink naar deze titel">¶</a></h2>
<p>In tegenstelling tot een LED die aangesloten werd op een GPIO-pin (die aan- en uit kon worden gezet) is een continue stroomtoevoer voor een sensor een betere keus. Rechtsonder op het bord zie je een <strong>3V3</strong> pin die deze stroomtoevoer biedt (zie ook figuur <a class="reference internal" href="2_micro_python.html#esp32-devkit"><span class="std std-numref">Fig. 2.2</span></a> voor meer detail).</p>
<div class="figure align-default" id="v3-connect">
<img alt="../_images/esp32_step_6_bb.png" src="../_images/esp32_step_6_bb.png" />
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">3V3 pin aansluiten</span><a class="headerlink" href="#v3-connect" title="Permallink naar deze afbeelding">¶</a></p>
</div>
<p>Het begint op het breadboard al aardig druk te worden met een led, kabels en een weerstand. De 3V3 pin bevindt zich aan de onderkant van het ravijn, we kiezen er voor om deze pin aan te sluiten op de onderste verticale strip, zie figuur <a class="reference internal" href="#v3-connect"><span class="std std-numref">Fig. 4.1</span></a>. Je zal hier de ESP32 even van het board moeten halen om de kabel te plaatsen, zorg er voor dat je een gaatje recht boven de 3V3 pin gebruikt zodat pin en kabel verticaal op de strip zijn aangesloten.</p>
</div>
<div class="section" id="temperatuursensor">
<h2><span class="section-number">4.2. </span>Temperatuursensor<a class="headerlink" href="#temperatuursensor" title="Permalink naar deze titel">¶</a></h2>
<div class="figure align-default" id="tmp36-sensor">
<img alt="../_images/tmp36.png" src="../_images/tmp36.png" />
<p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text">tmp36 temperatuursensor</span><a class="headerlink" href="#tmp36-sensor" title="Permallink naar deze afbeelding">¶</a></p>
</div>
<p>De tmp36 temperatuursensor heeft 3 aansluitingen, als je de kant met het label voor je houdt is <strong>links</strong> is de input (stroom in <span class="math notranslate nohighlight">\(+\)</span>), <strong>midden</strong> is <em>analoge output</em> en <strong>rechts</strong> is aarding (stroom uit <span class="math notranslate nohighlight">\(-\)</span>).</p>
<div class="figure align-default" id="tmp36-in-out">
<img alt="../_images/esp32_step_7_bb.png" src="../_images/esp32_step_7_bb.png" />
<p class="caption"><span class="caption-number">Fig. 4.3 </span><span class="caption-text">temp36 in- en output</span><a class="headerlink" href="#tmp36-in-out" title="Permallink naar deze afbeelding">¶</a></p>
</div>
<p>Plaats de tmp36 op het bord en sluit de in- en output aan, zie figuur <a class="reference internal" href="#tmp36-in-out"><span class="std std-numref">Fig. 4.3</span></a>.</p>
<div class="figure align-default" id="tmp36-analog-out">
<img alt="../_images/esp32_step_8_bb.png" src="../_images/esp32_step_8_bb.png" />
<p class="caption"><span class="caption-number">Fig. 4.4 </span><span class="caption-text">temp36 analoge output</span><a class="headerlink" href="#tmp36-analog-out" title="Permallink naar deze afbeelding">¶</a></p>
</div>
<p>Voor de middelste aansluiting, de analoge output, zal ook net als bij de LED weer een keus moeten worden gemaakt welke pin te gebruiken. Wij hebben hier gekozen voor GPIO-pin nummer 34, zie figuur <a class="reference internal" href="#tmp36-analog-out"><span class="std std-numref">Fig. 4.4</span></a>.</p>
</div>
<div class="section" id="temperatuur-meten">
<h2><span class="section-number">4.3. </span>Temperatuur meten<a class="headerlink" href="#temperatuur-meten" title="Permalink naar deze titel">¶</a></h2>
<p>De ESP32 zal op de pin analoge <em>input</em> ontvangen van de temperatuursensor, en je zal deze <em>analoge</em> waarde moeten converteren naar een <em>digitale</em> representatie die je uiteindelijk kan gebruiken voor het bepalen van de temperatuur in graden celsius.</p>
<p>Laten we dit stap voor stap doen, het is aan te raden om dit met MicroPython REPL uit te voeren. Later kan je deze stappen in jouw code overnemen.</p>
<div class="section" id="analoog-naar-digitaal">
<h3><span class="section-number">4.3.1. </span>Analoog naar digitaal<a class="headerlink" href="#analoog-naar-digitaal" title="Permalink naar deze titel">¶</a></h3>
<p>Om te beginnen zal je ook hier weer de klasse <code class="docutils literal notranslate"><span class="pre">Pin</span></code> moeten gebruiken én de klasse <a class="reference external" href="https://docs.micropython.org/en/latest/library/machine.ADC.html"><code class="docutils literal notranslate"><span class="pre">ADC</span></code></a> uit de module <code class="docutils literal notranslate"><span class="pre">machine</span></code> voor de analoog naar digitale conversie.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">machine</span> <span class="kn">import</span> <span class="n">Pin</span><span class="p">,</span> <span class="n">ADC</span>
</pre></div>
</div>
<p>Vervolgens heb je een instantie van de klasse <code class="docutils literal notranslate"><span class="pre">Pin</span></code> nodig, en noem deze bijzoorbeeld <code class="docutils literal notranslate"><span class="pre">tmp36</span></code>. Let op dat de modus <code class="docutils literal notranslate"><span class="pre">Pin.IN</span></code> is, want je gaat input <em>lezen</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tmp36</span> <span class="o">=</span> <span class="n">Pin</span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="n">Pin</span><span class="o">.</span><span class="n">IN</span><span class="p">)</span>
</pre></div>
</div>
<p>Maak een instantie van de klasse <code class="docutils literal notranslate"><span class="pre">ADC</span></code> aan en noem deze bijvoorbeeld <code class="docutils literal notranslate"><span class="pre">adc</span></code>. De klasse accepteert als argument een <code class="docutils literal notranslate"><span class="pre">Pin</span></code> instantie.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adc</span> <span class="o">=</span> <span class="n">ADC</span><span class="p">(</span><span class="n">tmp36</span><span class="p">)</span>
</pre></div>
</div>
<p>De klasse <code class="docutils literal notranslate"><span class="pre">ADC</span></code> heeft een methode <a class="reference external" href="https://docs.micropython.org/en/latest/library/machine.ADC.html#machine.ADC.read_u16"><code class="docutils literal notranslate"><span class="pre">read_u16</span></code></a> en deze zal een 16-bit waarde teruggeven op basis van de analoge input die het van de pin (sensor) ontvangt.</p>
<div class="admonition attention">
<p class="admonition-title">Let op</p>
<p>De nieuwere methode <code class="docutils literal notranslate"><span class="pre">ADC.read_u16</span></code> biedt een meer uniforme benadering voor het uitvoeren van analoge lezingen waarbij een waarde tussen 0 en 65535 wordt teruggegeven. MicroPython beveelt deze nieuwe methode aan in plaats van de methode <code class="docutils literal notranslate"><span class="pre">ADC.read</span></code> die je in veel tutorials nog gebruikt ziet worden.</p>
</div>
<p>De vraag is nu waar deze waarde voor staat, het kan tussen de 0 en 65535 liggen. Het geeft een verhouding aan tot iets, maar tot wat? Dit blijkt het <a class="reference external" href="https://docs.espressif.com/projects/esp-idf/en/latest/esp32/api-reference/peripherals/adc.html#adc-calibration"><em>ADC reference voltage</em></a> (Vref) te zijn, een gekalibreerd voltage, in het geval van de ESP32 is dit 1100 mV (millivolt).</p>
<p>Definiëer nu dit verhoudingsgetal en vermenigvuldig het met de 16-bit waarde en bewaar het resultaat.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">prop</span> <span class="o">=</span> <span class="mi">1100</span> <span class="o">/</span> <span class="mi">65535</span>

<span class="n">v_out</span> <span class="o">=</span> <span class="n">adc</span><span class="o">.</span><span class="n">read_u16</span><span class="p">()</span> <span class="o">*</span> <span class="n">prop</span>
</pre></div>
</div>
<p>Het resultaat <code class="docutils literal notranslate"><span class="pre">v_out</span></code> is een waarde in millivolt en de vraag is nu hoe dit voltage kan worden omgezet naar een temperatuur. Dit kan worden beantwoord met behulp van de tmp36 <a class="reference external" href="https://www.analog.com/media/en/technical-documentation/data-sheets/TMP35_36_37.pdf">documentatie</a>.</p>
<div class="figure align-default" id="tmp36-voltage-temp">
<img alt="../_images/tmp36_output_temperature.png" src="../_images/tmp36_output_temperature.png" />
<p class="caption"><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Relatie output voltage en temperatuur</span><a class="headerlink" href="#tmp36-voltage-temp" title="Permallink naar deze afbeelding">¶</a></p>
</div>
<p>In deze documentatie is een grafiek opgenomen die de relatie voltage (in millivolt) ten opzichte van temperatuur in graden celsius aangeeft, zie figuur <a class="reference internal" href="#tmp36-voltage-temp"><span class="std std-numref">Fig. 4.5</span></a>. Let hier in het bijzonder op lijn <em>b</em> die het gedrag van de tmp36 weergeeft. Op basis van deze informatie blijkt dat je de onderstaande formule kan toepassen om het voltage om te zetten naar temperatuur:</p>
<div class="math notranslate nohighlight">
\[
^oC = (V_{out} - 500) / 10
\]</div>
<p>De bepaling van de temperatuur is nu eenvoudig, wat volgt is de allerlaatste stap waar <code class="docutils literal notranslate"><span class="pre">temp</span></code> de waarde in graden celsius zal zijn.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="n">v_out</span> <span class="o">-</span> <span class="mi">500</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span>

<span class="nb">print</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
</pre></div>
</div>
<p>Je hebt nu succesvol led’s kunnen aansturen en een temperatuursensor kunnen uitlezen! Deze handelingen gaan in het volgende deel samenkomen in een klein project waar de microcontroller temperatuurmetingen over een netwerk gaat versturen en zal moeten reageren op berichten.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="3_aansluitingen.html" title="vorige pagina">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">vorige</p>
            <p class="prev-next-title"><span class="section-number">3. </span>Aansluitingen</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="5_project.html" title="volgende pagina">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">volgende</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Project</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      Door Hanzehogeschool Groningen<br/>
    
        &copy; auteursrechten CC BY-NC-SA 4.0.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>